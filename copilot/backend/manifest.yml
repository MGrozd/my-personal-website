name: backend
type: Backend Service

image:
  build:
    context: ./backend
    dockerfile: ./backend/Dockerfile
  port: 8000


variables:
  PROJECT_NAME: my-personal-website

secrets:
  FIRST_SUPERUSER: my-personal-website/FIRST_SUPERUSER
  FIRST_SUPERUSER_PASSWORD: my-personal-website/FIRST_SUPERUSER_PASSWORD

cpu: 256
memory: 512
count: 1

autoscaling:
  range: 1-3
  cpu_percentage: 70
  memory_percentage: 75

healthcheck:
  command: ["CMD-SHELL", "curl -f http://localhost:8000/api/v1/ || exit 1"]
  interval: 10s
  timeout: 5s
  retries: 2
  start_period: 30s

environments:
  production:
    variables:
      ENV: production
